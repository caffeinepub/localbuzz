{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 17,
  "summary": "LocalBuzz mobile app with OTP login for Shop Owners and Customers, role selection after login, routing to Shop Dashboard or Customer Home Feed, clean UI, location permission, a Shop Owner registration flow that creates a Shop record linked to the owner user ID, and a Shop Owner 'Post Update' feature that creates expiring shop updates with optional image and attached shop location stored in a ShopUpdates collection.",
  "architectural_notes": [
    "Two user roles: Shop Owner and Customer.",
    "Authentication via mobile OTP for all users.",
    "After OTP login, user selects role and is routed accordingly (Shop Dashboard or Customer Home Feed).",
    "App requires location permission.",
    "Phone number input/OTP login should default to India country code (+91).",
    "Add a 'Shops' data model/table/collection to store Shop Owner registration details (shop name, category, address, latitude/longitude, image URL/path) and link each shop record to the owning user ID.",
    "Add a 'ShopUpdates' data model/table/collection storing shop updates: shopId, title, optional description, optional image URL/path, expiryDate, created timestamp, and shop location (lat/long) auto-attached to each post."
  ],
  "known_issues": [
    "OTP login phone number country code is incorrect; should be India (+91).",
    "Users are not receiving OTP SMS on their phone numbers during login.",
    "Location permission is being denied (location access request/handling is not working as expected).",
    "App generation/build failed when attempting to create the Shop Dashboard (needs retry/fix)."
  ],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-create-the-basic-localbuzz-app-structure-with-mobile-first-navigation-and-three-primary-flows-screens-1-login-2-role-selection-shop-owner-vs-customer-and-3-post-login-destinations-shop-dashboard-and-customer-home-feed",
      "title": "Create the basic LocalBuzz app structure with mobile-first navigation and three primary flows/screens: (1) Login, (2) Role Selection (Shop Owner vs Customer), and (3) post-login destinations: Shop Dashboard and Customer Home Feed.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-phone-number-otp-style-login-flow-for-both-user-types-collect-a-phone-number-request-an-otp-then-verify-the-otp-to-create-an-authenticated-session-for-the-current-principal",
      "title": "Implement a phone-number OTP-style login flow for both user types: collect a phone number, request an OTP, then verify the OTP to create an authenticated session for the current principal.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-request-location-access-permission-on-the-client-and-when-granted-capture-the-user-s-current-coordinates-display-basic-location-status-in-the-ui-and-optionally-persist-the-last-known-location-to-the-backend-user-profile",
      "title": "Request location access permission on the client and, when granted, capture the user’s current coordinates; display basic location status in the UI and optionally persist the last known location to the backend user profile.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-clean-simple-consistent-visual-theme-for-localbuzz-across-all-screens-mobile-first-layout-typography-spacing-and-a-distinct-color-palette-that-is-not-blue-purple",
      "title": "Apply a clean, simple, consistent visual theme for LocalBuzz across all screens (mobile-first layout, typography, spacing, and a distinct color palette that is not blue & purple).",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-otp-login-phone-number-input-to-use-india-as-the-default-country-code-91-and-ensure-the-stored-returned-phone-number-is-normalized-to-an-india-91-e-164-style-value-before-continuing-the-login-flow",
      "title": "Update the OTP login phone number input to use India as the default country code (+91) and ensure the stored/returned phone number is normalized to an India (+91) E.164-style value before continuing the login flow.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-current-simulated-otp-flow-which-does-not-send-any-sms-with-a-functional-otp-challenge-flow-that-lets-the-user-obtain-an-otp-code-inside-the-app-and-verify-it-so-the-login-can-proceed-reliably-even-without-sms-delivery",
      "title": "Replace the current simulated OTP flow (which does not send any SMS) with a functional OTP challenge flow that lets the user obtain an OTP code inside the app and verify it, so the login can proceed reliably even without SMS delivery.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-otp-ui-copy-and-states-in-the-login-card-to-match-the-actual-behavior-no-claim-that-an-sms-was-sent-and-add-a-clear-resend-code-action-on-the-otp-entry-step",
      "title": "Update the OTP UI copy and states in the login card to match the actual behavior (no claim that an SMS was sent), and add a clear 'Resend code' action on the OTP entry step.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-harden-otp-input-validation-and-error-handling-so-common-user-mistakes-are-handled-clearly-wrong-length-non-numeric-wrong-code-expired-code-and-do-not-accidentally-authenticate-the-user",
      "title": "Harden OTP input validation and error handling so common user mistakes are handled clearly (wrong length, non-numeric, wrong code, expired code) and do not accidentally authenticate the user.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-location-permission-hook-to-correctly-detect-and-reflect-the-browser-s-actual-geolocation-permission-state-on-load-and-after-user-actions-instead-of-defaulting-to-a-generic-denied-error-state",
      "title": "Update the location permission hook to correctly detect and reflect the browser’s actual geolocation permission state on load and after user actions, instead of defaulting to a generic 'denied' error state.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-error-handling-for-geolocation-failures-so-users-can-reliably-recover-distinguish-permission-denial-vs-timeout-vs-position-unavailable-provide-clear-english-error-messages-and-allow-retry-flows-from-the-ui",
      "title": "Improve error handling for geolocation failures so users can reliably recover: distinguish permission denial vs timeout vs position unavailable, provide clear English error messages, and allow retry flows from the UI.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-locationstatuscard-ui-to-support-the-improved-permission-states-and-recovery-actions-including-showing-an-enable-retry-control-when-permission-is-denied-and-displaying-guidance-text-appropriate-to-each-error-state",
      "title": "Update the LocationStatusCard UI to support the improved permission states and recovery actions, including showing an enable/retry control when permission is denied and displaying guidance text appropriate to each error state.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-visible-back-navigation-control-on-every-top-level-page-route-in-the-localbuzz-app-login-role-selection-shop-dashboard-customer-home-positioned-consistently-in-the-page-header-area-using-english-user-facing-text-e-g-an-accessible-icon-button-with-an-aria-label-like-back-the-back-control-must-navigate-to-the-previous-in-app-route-when-possible-and-must-not-break-authentication-session-state",
      "title": "Add a visible Back navigation control on every top-level page/route in the LocalBuzz app (Login, Role Selection, Shop Dashboard, Customer Home), positioned consistently in the page header area, using English user-facing text (e.g., an accessible icon button with an aria-label like \"Back\"). The Back control must navigate to the previous in-app route when possible and must not break authentication/session state.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-shop-owner-registration-page-containing-a-form-with-the-following-fields-and-controls-shop-name-text-category-dropdown-grocery-clothing-electronics-medical-food-other-shop-address-text-textarea-auto-detected-gps-location-latitude-longitude-displayed-and-shop-image-upload-file-picker-with-preview",
      "title": "Create a Shop Owner registration page containing a form with the following fields and controls: Shop Name (text), Category (dropdown: Grocery, Clothing, Electronics, Medical, Food, Other), Shop Address (text/textarea), auto-detected GPS location (latitude & longitude displayed), and Shop Image upload (file picker with preview).",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-shop-registration-ui-to-backend-apis-using-react-query-hooks-including-loading-success-and-error-handling-and-ensure-the-created-shop-is-persisted-and-can-be-reloaded-for-the-same-owner",
      "title": "Wire the Shop registration UI to backend APIs using React Query hooks, including loading, success, and error handling, and ensure the created Shop is persisted and can be reloaded for the same owner.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-add-navigation-from-the-shop-dashboard-to-the-shop-registration-page-so-a-shop-owner-can-access-the-registration-form-from-the-main-shop-flow",
      "title": "Add navigation from the Shop Dashboard to the Shop registration page so a Shop Owner can access the registration form from the main Shop flow.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-shop-dashboard-page-to-match-the-requested-simple-layout-by-adding-1-a-primary-button-labeled-post-update-2-a-toggle-control-to-mark-the-shop-as-open-or-closed-3-a-section-titled-my-active-posts-and-4-a-section-titled-expired-posts",
      "title": "Update the Shop Dashboard page to match the requested simple layout by adding: (1) a primary button labeled \"Post Update\", (2) a toggle control to mark the shop as \"Open\" or \"Closed\", (3) a section titled \"My Active Posts\", and (4) a section titled \"Expired Posts\".",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-shop-dashboard-still-supports-the-existing-shop-registration-edit-entrypoint-when-the-caller-has-no-shop-record-show-a-clear-cta-to-register-when-a-shop-exists-allow-navigating-to-the-shop-registration-page-to-edit",
      "title": "Ensure the Shop Dashboard still supports the existing shop registration/edit entrypoint: when the caller has no shop record, show a clear CTA to register; when a shop exists, allow navigating to the shop registration page to edit.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-for-my-active-posts-and-expired-posts-sections-implement-simple-empty-states-english-text-when-there-are-no-items-without-adding-backend-persistence-yet",
      "title": "For \"My Active Posts\" and \"Expired Posts\" sections, implement simple empty states (English text) when there are no items, without adding backend persistence yet.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-shop-owner-post-update-ui-flow-when-the-shop-owner-taps-post-update-from-the-shop-dashboard-navigate-to-a-new-page-containing-a-form-with-fields-title-short-text-description-optional-optional-image-upload-with-preview-and-expiry-option-today-2-days-custom-date",
      "title": "Create a Shop Owner \"Post Update\" UI flow: when the Shop Owner taps \"Post Update\" from the Shop Dashboard, navigate to a new page containing a form with fields Title (short text), Description (optional), Optional Image upload (with preview), and Expiry option (Today / 2 Days / Custom Date).",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-post-update-form-to-backend-apis-using-react-query-on-submit-create-a-shopupdate-show-loading-state-show-a-success-confirmation-in-english-and-navigate-back-to-the-shop-dashboard-or-otherwise-reset-the-form-after-success",
      "title": "Wire the Post Update form to backend APIs using React Query: on submit, create a ShopUpdate, show loading state, show a success confirmation in English, and navigate back to the Shop Dashboard (or otherwise reset the form) after success.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-shop-dashboard-to-display-real-data-in-my-active-posts-and-expired-posts-sections-by-fetching-shopupdates-for-the-caller-keep-the-existing-english-empty-states-when-there-are-no-items",
      "title": "Update the Shop Dashboard to display real data in \"My Active Posts\" and \"Expired Posts\" sections by fetching ShopUpdates for the caller; keep the existing English empty states when there are no items.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-expiry-date-selection-is-correctly-converted-to-a-backend-timestamp-today-end-of-day-or-within-same-day-2-days-now-2-days-and-custom-date-user-selected-date",
      "title": "Ensure Expiry Date selection is correctly converted to a backend timestamp: Today (end of day or within same day), 2 Days (now + 2 days), and Custom Date (user-selected date).",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Create basic LocalBuzz app structure with clean, simple UI",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Implement mobile OTP login flow for both Shop Owner and Customer users",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Post-login role selection (Shop Owner vs Customer) and redirect to Shop Dashboard or Customer Home Feed",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Request and use location access permission in the app",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Persist a minimal user profile in the backend keyed to the authenticated principal, including phone number, selected role (Shop Owner or Customer), and timestamps; expose APIs to read/update the current user profile.",
      "reqIds": [
        "REQ-3"
      ],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Add a back button option on every screen/page throughout the app for consistent navigation",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Shop Owner registration form to create a Shop (name, category dropdown, address, auto-detected GPS lat/long, image upload) saved under 'Shops' and linked to the owner's user ID",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Add backend support for a new \"Shops\" collection that stores Shop Owner registration data (shop name, category, address, GPS latitude/longitude, and a shop image) and links each Shop record to the authenticated owner user ID (caller Principal).",
      "reqIds": [
        "REQ-14"
      ],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Create Shop Dashboard UI with Post Update button, Open/Closed toggle, My Active Posts section, and Expired Posts section (simple layout)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Implement Shop Owner 'Post Update' flow: open a form (title, optional description, optional image, expiry Today/2 Days/Custom Date), auto-attach shop location, and save to a ShopUpdates collection with shopId, fields, expiry date, timestamp, and lat/long.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Add backend support for a new \"ShopUpdates\" collection that persists shop owner posts with the following fields: Shop ID, Title, Description (optional), Image (optional), Expiry Date, Timestamp, and Shop Location (latitude, longitude).",
      "reqIds": [
        "REQ-21"
      ],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Implement backend APIs to create and fetch ShopUpdates for the current shop owner, ensuring each created update automatically attaches the shop’s registered location (latitude/longitude) to the post.",
      "reqIds": [
        "REQ-22"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "LocalBuzz",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}